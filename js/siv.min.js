/*
 * The MIT License
 *
 * (MIT)Copyright (c) 2015 artjomb
 */
!function(t){var e;e=t.hasOwnProperty("ext")?t.ext:t.ext={},e.bitshift=function(t,e){var r,i,s=0,n=t.words,o=0;if(e>0){for(;e>31;)n.splice(0,1),n.push(0),e-=32,o++;if(0==e)return s;for(var a=n.length-o-1;a>=0;a--)r=n[a],n[a]<<=e,n[a]|=s,s=r>>>32-e}else if(0>e){for(;-31>e;)n.splice(0,0,0),n.length--,e+=32,o++;if(0==e)return s;e=-e,i=(1<<e)-1;for(var a=o;a<n.length;a++)r=n[a]&i,n[a]>>>=e,n[a]|=s,s=r<<32-e}return s},e.neg=function(t){for(var e=t.words,r=0;r<e.length;r++)e[r]=~e[r];return t},e.xor=function(t,e){for(var r=0;r<t.words.length;r++)t.words[r]^=e.words[r];return t},e.bitand=function(t,e){for(var r=t.clone(),i=r.words,s=e.words,n=0;n<i.length;n++)i[n]&=s[n];return r}}(CryptoJS),function(t){var e;e=t.hasOwnProperty("ext")?t.ext:t.ext={};{var r=(t.lib.Base,t.lib.WordArray);t.algo.AES}e.const_Zero=r.create([0,0,0,0]),e.const_One=r.create([0,0,0,1]),e.const_Rb=r.create([0,0,0,135]),e.const_Rb_Shifted=r.create([2147483648,0,0,67]),e.const_nonMSB=r.create([4294967295,4294967295,2147483647,2147483647]),e.isWordArray=function(t){return t&&"function"==typeof t.clamp&&"function"==typeof t.concat&&"array"==typeof t.words},t.pad.OneZeroPadding={pad:function(t,e){for(var i=4*e,s=i-t.sigBytes%i,n=[],o=0;s>o;o+=4){var a=0;0===o&&(a=2147483648),n.push(a)}var c=r.create(n,s);t.concat(c)},unpad:function(){}},t.pad.NoPadding={pad:function(){},unpad:function(){}},e.leftmostBytes=function(t,e){var r=t.clone();return r.sigBytes=e,r.clamp(),r},e.rightmostBytes=function(t,r){t.clamp();var i=32,s=t.clone(),n=8*(s.sigBytes-r);if(n>=i){var o=Math.floor(n/i);n-=o*i,s.words.splice(0,o),s.sigBytes-=o*i/8}return n>0&&(e.bitshift(s,n),s.sigBytes-=n/8),s},e.popWords=function(t,r){var i=e.leftmostBytes(t,4*r);return t.words=t.words.slice(r),t.sigBytes-=4*r,i},e.shiftBytes=function(t,i){i=i||16;var s=i%4;i-=s;for(var n=r.create(),o=0;i>o;o+=4)n.words.push(t.words.shift()),t.sigBytes-=4,n.sigBytes+=4;return s>0&&(n.words.push(t.words[0]),n.sigBytes+=s,e.bitshift(t,8*s),t.sigBytes-=s),n},e.xorendBytes=function(t,r){return e.leftmostBytes(t,t.sigBytes-r.sigBytes).concat(e.xor(e.rightmostBytes(t,r.sigBytes),r))},e.dbl=function(t){var r=e.msb(t);return e.bitshift(t,1),e.xor(t,1===r?e.const_Rb:e.const_Zero),t},e.inv=function(t){var r=1&t.words[4];return e.bitshift(t,-1),e.xor(t,1===r?e.const_Rb_Shifted:e.const_Zero),t},e.equals=function(t,e){if(!e||!e.words||t.sigBytes!==e.sigBytes)return!1;t.clamp(),e.clamp();for(var r=0,i=0;i<t.words.length;i++)r|=t.words[i]^e.words[i];return 0===r},e.msb=function(t){return t.words[0]>>>31}}(CryptoJS),function(t){function e(e,r){var n=s.createEncryptor(e,{iv:i.create(),padding:t.pad.NoPadding}),o=n.finalize(r);return o}var r=t.lib.Base,i=t.lib.WordArray,s=t.algo.AES,n=t.ext,o=t.pad.OneZeroPadding,a=t.algo.CMAC=r.extend({init:function(t){var r=e(t,n.const_Zero),i=r.clone();if(n.dbl(i),this._isTwo){var s=r.clone();n.inv(s)}else{var s=i.clone();n.dbl(s)}this._K1=i,this._K2=s,this._K=t,this._const_Bsize=16,this.reset()},reset:function(){this._x=n.const_Zero.clone(),this._counter=0,this._buffer=i.create()},update:function(r){if(!r)return this;var i=this._buffer,s=this._const_Bsize;for("string"==typeof r&&(r=t.enc.Utf8.parse(r)),i.concat(r);i.sigBytes>s;){var o=n.shiftBytes(i,s);n.xor(this._x,o),this._x.clamp(),this._x=e(this._K,this._x),this._counter++}return this},finalize:function(t){this.update(t);var r=this._buffer,i=this._const_Bsize,s=r.clone();return r.sigBytes===i?n.xor(s,this._K1):(o.pad(s,i/4),n.xor(s,this._K2)),n.xor(s,this._x),this.reset(),e(this._K,s)},_isTwo:!1});t.CMAC=function(t,e){return a.create(t).finalize(e)},t.algo.OMAC1=a,t.algo.OMAC2=a.extend({_isTwo:!0})}(CryptoJS),function(t){{var e=t.lib.Base,r=t.lib.WordArray,i=(t.algo.AES,t.ext),s=t.pad.OneZeroPadding,n=t.algo.CMAC,o=t.algo.S2V=e.extend({init:function(t){this._blockSize=16,this._cmacAD=n.create(t),this._cmacPT=n.create(t),this.reset()},reset:function(){this._buffer=r.create(),this._cmacAD.reset(),this._cmacPT.reset(),this._d=this._cmacAD.finalize(i.const_Zero),this._empty=!0,this._ptStarted=!1},updateAAD:function(e){return this._ptStarted?this:e?("string"==typeof e&&(e=t.enc.Utf8.parse(e)),this._d=i.xor(i.dbl(this._d),this._cmacAD.finalize(e)),this._empty=!1,this):this},update:function(e){if(!e)return this;this._ptStarted=!0;var r=this._buffer,s=this._blockSize,n=s/4,o=this._cmacPT;for("string"==typeof e&&(e=t.enc.Utf8.parse(e)),r.concat(e);r.sigBytes>=2*s;){this._empty=!1;var a=i.popWords(r,n);o.update(a)}return this},finalize:function(t){this.update(t);var e=this._blockSize,r=this._buffer;if(this._empty&&0===r.sigBytes)return this._cmacAD.finalize(i.const_One);var n;return r.sigBytes>=e?n=i.xorendBytes(r,this._d):(s.pad(r,e),n=i.xor(i.dbl(this._d),r)),this._cmacPT.finalize(n)}});t.SIV=e.extend({init:function(t){var e=t.sigBytes/2;this._s2vKey=i.shiftBytes(t,e),this._ctrKey=t},encrypt:function(e,r){!r&&e&&(r=e,e=[]);var s=o.create(this._s2vKey);Array.prototype.forEach.call(e,function(t){s.updateAAD(t)});var n=s.finalize(r),a=i.bitand(n,i.const_nonMSB),c=t.AES.encrypt(r,this._ctrKey,{iv:a,mode:t.mode.CTR,padding:t.pad.NoPadding});return n.concat(c.ciphertext)},decrypt:function(e,r){!r&&e&&(r=e,e=[]);var s=i.shiftBytes(r,16),n=i.bitand(s,i.const_nonMSB),a=t.AES.decrypt({ciphertext:r},this._ctrKey,{iv:n,mode:t.mode.CTR,padding:t.pad.NoPadding}),c=o.create(this._s2vKey);Array.prototype.forEach.call(e,function(t){c.updateAAD(t)});var f=c.finalize(a);return i.equals(s,f)?a:!1}})}}(CryptoJS);